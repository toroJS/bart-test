<div class="gameWrapper">
  <mat-card class="gameScorecard">
    <mat-card-header class="gameScore">
      <!-- TODO: Add user name -->
      <mat-card-subtitle>{{ username }}</mat-card-subtitle>
      <div>
        <strong>TOTAL: (ðŸ’° {{ totalPoints$ | async }})</strong>
        @if(!(burts$ | async) && !(gameEnd$ | async) && ((balloonSize$ | async)
        ?? 0) > 0){
        <span style="color: green"> + {{ balloonSize$ | async }}</span>
        }
      </div>
    </mat-card-header>
    <mat-card-footer>
      <!-- TODO: Correctly show progress, we need to calculate current round vs total and put that in a range of 0 to 100-->
      <mat-progress-bar
        mode="determinate"
        value="{{ progress$ | async }}"
      ></mat-progress-bar>
    </mat-card-footer>
  </mat-card>

  <app-balloon
    [size]="(balloonSize$ | async) ?? 1"
    [burst]="(burts$ | async) ?? false"
  ></app-balloon>

  <div class="gameActions">
    @if(gameEnd$ | async) {
    <h1>game finished</h1>
    } @else { @if( !(burts$ | async) ) {
    <button
      [disabled]="disable"
      mat-flat-button
      color="accent"
      style="width: 48%"
      (click)="onButtonClick(ACTIONTYPE.PUMP)"
    >
      Inflate
    </button>
    } @if( !(burts$ | async) && ((balloonSize$ | async) ?? 0) > 0) {
    <button
      [disabled]="disable"
      mat-flat-button
      color="primary"
      style="width: 48%"
      (click)="onButtonClick(ACTIONTYPE.COLLECT)"
    >
      Collect <strong> (+ {{ balloonSize$ | async }})</strong>
    </button>
    } @if( (burts$ | async)) {
    <button
      [disabled]="disable"
      mat-flat-button
      color="primary"
      (click)="onButtonClick(ACTIONTYPE.NEXT_ROUND)"
    >
      Next round
    </button>
    } }
  </div>
</div>
